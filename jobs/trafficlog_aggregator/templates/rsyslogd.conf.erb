$MaxMessageSize 4k

# Caveat - This always binds to all interfaces (cannot specify otherwise).
$ModLoad imtcp
$InputTCPMaxSessions 1024
$InputTCPServerRun <%= properties.report_processor.syslog_aggregator.port %>
$PrivDropToUser vcap
$PrivDropToGroup vcap

# Directory is created automatically
$template RouterAccessLogFile, "/var/vcap/store/log/router_access/%$year%/%$month%/%$day%/router_access.log"
$template RouterAccessLogFormat, "%fromhost-ip% -- %msg%\n"

# The initial '-' tells rsyslogd to not sync the file after each write
:syslogtag, isequal, "router" -?RouterAccessLogFile;RouterAccessLogFormat

# Prevent them from reaching anywhere else
:syslogtag, isequal, "router" ~
