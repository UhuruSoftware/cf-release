pid_filename: /var/vcap/sys/run/simple_webui/simple_webui.pid
local_route: <%= spec.networks.send(properties.networks.apps).ip %>
port: <%= properties.uhuru.simple_webui.port || 9191 %>

ui_settings:
  cloud_name: "<%= properties.uhuru.simple_webui.cloud_name || "Uhuru Cloud" %>"
  cloud_admin_download_url: "<%= properties.uhuru.simple_webui.cloud_admin_download_url || "http://www.uhurucloud.com/tools/cloudadmin" %>"
  visual_studio_plugin_download_url: "<%= properties.uhuru.simple_webui.visual_studio_plugin_download_url || "http://www.uhurucloud.com/tools/visualstudio" %>"
  vmc_url: "<%= properties.uhuru.simple_webui.vmc_url || "http://docs.cloudfoundry.com/tools/vmc/installing-vmc.html" %>"
  eclipse_url: "<%= properties.uhuru.simple_webui.eclipse_url || "http://docs.cloudfoundry.com/tools/STS/configuring-STS.html" %>"
  signup_message: "<%= properties.uhuru.simple_webui.signup_message || "Host your web applications in minutes. We support apps written in PHP, Node.js, Ruby, Java and .NET. Sign up for your free account now. Find more details about our Cloud features on our web site." %>"
  copyright_message: "<%= properties.uhuru.simple_webui.copyright_message || "&copy; Copyright Uhuru Software 2012" %>"
  welcome_message: "<%= properties.uhuru.simple_webui.welcome_message || "Uhuru PaaS" %>"
  color_theme: "<%= properties.uhuru.simple_webui.color_theme || "simple_white" %>"
<% if properties.uhuru.simple_webui && properties.uhuru.simple_webui.domain %>
  domain: "<%= properties.uhuru.simple_webui.domain %>"
<% else %>
  domain: "www.<%= properties.domain %>"
<% end %>
  recaptcha_public_key: "<%= properties.uhuru.simple_webui.recaptcha_public_key %>"
  recaptcha_private_key: "<%= properties.uhuru.simple_webui.recaptcha_private_key %>"
  activation_link_secret: "<%= properties.uhuru.simple_webui.activation_link_secret %>"

# if e-mail settings are not properly setup the site won't work
# e-mail activation is required
email:
  from: "<%= properties.uhuru.simple_webui.email.from || "postmaster@uhurusoftware.mailgun.org" %>"
  from_alias: "<%= properties.uhuru.simple_webui.email.from_alias || "Uhuru Cloud" %>"
  server: "<%= properties.uhuru.simple_webui.email.server || "smtp.mailgun.org" %>"
  port: <%= properties.uhuru.simple_webui.email.port || 587 %>
  user: "<%= properties.uhuru.simple_webui.email.user || "postmaster@uhurusoftware.mailgun.org" %>"
  secret: "<%= properties.uhuru.simple_webui.email.secret || "4q899o1avzu3" %>"
  auth_method: <%= properties.uhuru.simple_webui.email.auth_method || ":plain" %>
  enable_tls: <%= properties.uhuru.simple_webui.email.enable_tls || true %>

contact:
  company: "<%= properties.uhuru.simple_webui.contact.company || "Uhuru Software, Inc." %>"
  address: "<%= properties.uhuru.simple_webui.contact.address || "17530 NE Union Hill Road, Suite 120, Redmond, WA 98052, USA." %>"
  phone: "<%= properties.uhuru.simple_webui.contact.phone || "+1 (425) 406-6383" %>"
  email: "<%= properties.uhuru.simple_webui.contact.email || "uhuru@uhurusoftware.com" %>"

<% ccdb_prop_name = properties.db || 'ccdb' %>
<% ccdb = properties.send(ccdb_prop_name) %>
<% db_name = ccdb.databases.find { |db| db.tag == "cc" }.name %>
<% db_role = ccdb.roles.find { |role| role.tag == "admin" } %>
audit_database:
  host: <%= ccdb.address %>
  port: <%= ccdb.port %>
  database: <%= db_name %>
  username: <%= db_role.name %>
  password: "<%= db_role.password %>" 

cloudfoundry:
  target: "http://api.<%= properties.domain %>"
  admin_email: "<%= properties.uhuru.simple_webui.admin_email%>"
  admin_password: "<%= properties.uhuru.simple_webui.admin_password%>"
  default_random_password: "<%= properties.uhuru.simple_webui.default_random_password%>"

logging:
  level: <%= properties.uhuru.simple_webui.logging_level || "debug" %>
  file: /var/vcap/sys/log/simple_webui/simple_webui.log

<% mdb_prop_name = properties.db || 'monitoring' %>
<% mdb = properties.send(mdb_prop_name) %>
<% mdb_name = mdb.databases.find { |db| db.tag == "monitoring" }.name %>
<% mdb_role = mdb.roles.find { |role| role.tag == "monitoring" } %>
monitoring:
  reports:
    half_of_day:
      resolution: 30
      resolution_unit: 'minutes'
      sample_count: 30
    last_day:
      resolution: 1
      resolution_unit: 'hours'
      sample_count: 30
    last_week:
      resolution: 6
      resolution_unit: 'hours'
      sample_count: 30
    last_month:
      resolution: 1
      resolution_unit: 'days'
      sample_count: 30
    last_year:
      resolution: 1
      resolution_unit: 'months'
      sample_count: 30
  vmc_executable_path: vmc
  cloud_user: "<%= properties.uhuru.simple_webui.monitoring.cloud_user %>"
  cloud_password: "<%= properties.uhuru.simple_webui.monitoring.cloud_password %>"
  email_to: "<%= properties.uhuru.simple_webui.monitoring.email_to %>"
  database:
    database: "<%= mdb_name %>" 
    host: <%= mdb.address %>
    port: <%= mdb.port %>
    encoding: utf8
    username: <%= mdb_role.name %>
    password: <%= mdb_role.password %> 
    adapter: postgresql
    timeout: 2000
